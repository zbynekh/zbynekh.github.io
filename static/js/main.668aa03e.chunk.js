(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(e,t,n){e.exports=n.p+"static/media/icons.ad9cca36.svg"},283:function(e,t,n){e.exports=n.p+"static/media/streetview-not-found.5471f2dd.png"},285:function(e,t,n){e.exports=n(597)},290:function(e,t,n){},490:function(e,t,n){},590:function(e,t,n){},591:function(e,t,n){},592:function(e,t,n){},593:function(e,t,n){},594:function(e,t,n){},597:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(75),i=n.n(o),c=(n(290),n(15)),l=n(27),s=n(24),u=n(23),d=n(25),f=n(110),p=n(280),m=n.n(p),h="AIzaSyA7RQABjPCiCvlHYTIRvFvmJP_28x-OSMA",v="https://maps.googleapis.com/maps/api/js?key=".concat(h,"&v=3.exp"),g="https://maps.googleapis.com/maps/api/streetview?&key=".concat(h),_="https://maps.googleapis.com/maps/api/streetview/metadata?&key=".concat(h),C={lat:49.8196527,lng:16.0559093},y=8,b=n(281),w=n.n(b),k=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r))))._onMarkerClick=function(e){n.props.onClick(n.props.id,e.latLng)},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.id,e.latLng),n=e.name,a=e.showLabels;return r.a.createElement(w.a,{labelAnchor:new google.maps.Point(-20,30),labelClass:"marker-with-label",onClick:this._onMarkerClick,position:{lat:t.lat,lng:t.lng},title:n},r.a.createElement("span",null,a&&n))}}]),t}(a.Component);k.displayName="CustomMarker";n(490);var O=new Map([["alcohol","Pry\u010d od alkoholu"],["drugs","Pry\u010d od drog"],["crisis_services","Pry\u010d s probl\xe9my"],["free_time","Pry\u010d z nudy"]]),E=n(282),j=n.n(E),S=function(e,t){var n=W(t),a=n.categoryKey?e.filter(function(e){return L(e.serviceCategories.value,n.categoryKey)}):e;if(n.fullText){var r={keys:["name.value","city.value"],maxPatternLength:32,threshold:.2};return new j.a(a,r).search(n.fullText)}return a},W=function(e){var t=null,n=e;if(O.forEach(function(n,a){e.startsWith(n)&&(t=a)}),t){var a=O.get(t);n=n.replace(a,"")}return{categoryKey:t,fullText:n}},L=function(e,t){return e.some(function(e){return e.codename===t})},x=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e)))._mapComponent=null,n._onMarkerClick=function(e,t){n.props.onWelfareCentreSelected(e),n._mapComponent.panTo(t)},n._onZoomChanged=function(){n.setState(function(){return{currentZoom:n._mapComponent.getZoom()}})},n._fitBoundsToVisibleMarkers=function(e){var t=new google.maps.LatLngBounds;e.forEach(function(e){var n=new google.maps.LatLng(e.gpsLatitude.value,e.gpsLongitude.value);t.extend(n)}),n._mapComponent.fitBounds(t)},n.state={currentLocation:C,currentZoom:y},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"_tryGetCurrentLocation",value:function(){var e=this;navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){e.setState(function(){return{currentLocation:{lat:t.coords.latitude,lng:t.coords.longitude},currentZoom:13}})})}},{key:"componentDidMount",value:function(){this._tryGetCurrentLocation()}},{key:"componentDidUpdate",value:function(e){var t=this.props.welfareCentres;if(t!==e.welfareCentres&&t.length>0){var n=this.state.currentLocation&&function(e,t){return e.filter(function(e){return t.contains({lat:e.gpsLatitude.value,lng:e.gpsLongitude.value})})}(t,this._mapComponent.getBounds()),a=n.length>1?n:t;this._fitBoundsToVisibleMarkers(a)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.isMobileView,a=t.onMapFocused,o=t.welfareCentres,i=this.state,c=i.currentZoom,l=i.currentLocation;return r.a.createElement(f.GoogleMap,{center:l,defaultCenter:C,defaultZoom:y,onZoomChanged:this._onZoomChanged,onClick:a,options:{fullscreenControl:!1,mapTypeControlOptions:{position:n?google.maps.ControlPosition.BOTTOM_RIGHT:google.maps.ControlPosition.TOP_RIGHT},maxZoom:18},ref:function(t){return e._mapComponent=t},zoom:c},o&&r.a.createElement(m.a,{averageCenter:!0,enableRetinaIcons:!0,gridSize:25},o.map(function(t){return r.a.createElement(k,{id:t.system.codename,key:t.system.codename,latLng:{lat:t.gpsLatitude.value,lng:t.gpsLongitude.value},name:t.name.value,onClick:e._onMarkerClick,showLabels:c>12})})))}}]),t}(a.PureComponent);x.displayName="Map";var P=n(55),N=n(60),T=n.n(N),I=n(94),M="App_GoBack",B="App_Init_Finished",z="App_Map_Focused",R="App_Search_Confirmed",A="App_Search_Focused",D="App_WelfareCentre_Selected",H="App_Window_Resized",F=n(111),V=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this,{propertyResolver:function(e){return"service_categories"===e?"serviceCategories":"service_description"===e?"serviceDescription":"opening_hours"===e?"openingHours":"gps_latitude"===e?"gpsLatitude":"gps_longitude"===e?"gpsLongitude":e}}))).name=void 0,e.serviceCategories=void 0,e.serviceDescription=void 0,e.openingHours=void 0,e.street=void 0,e.city=void 0,e.zip=void 0,e.gpsLatitude=void 0,e.gpsLongitude=void 0,e.phone=void 0,e.web=void 0,e}return Object(d.a)(t,e),t}(F.ContentItem),Z=new F.DeliveryClient({projectId:"63208e4e-b4d4-00d2-78df-cfe9db943907",typeResolvers:[new F.TypeResolver("welfare_centre",function(){return new V})]}),U=function(){return Z.items().type("welfare_centre").elementsParameter(["name","service_categories","city","gps_latitude","gps_longitude"]).getPromise()},G=function(e){return Z.item(e).getPromise()},X=function(){return function(){var e=Object(I.a)(T.a.mark(function e(t){var n;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U();case 2:n=e.sent,t((a={loadedWelfareCentres:n.items},{type:B,payload:a}));case 4:case"end":return e.stop()}var a},e)}));return function(t){return e.apply(this,arguments)}}()},J=function(e){return function(){var t=Object(I.a)(T.a.mark(function t(n,a){var r,o,i;return T.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=a(),o=r.loadedWelfareCentres,i=S(o,e),n({type:R,payload:{filteredWelfareCentres:i}});case 3:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()},K=function(e){return function(){var t=Object(I.a)(T.a.mark(function t(n,a){var r,o,i;return T.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=a(),(o=r.selectedWelfareCentre)&&o.system.codename==e){t.next=7;break}return t.next=5,G(e);case 5:i=t.sent,n((c={selectedWelfareCentre:i.item},{type:D,payload:c}));case 7:case"end":return t.stop()}var c},t)}));return function(e,n){return t.apply(this,arguments)}}()},Q=Object(f.withScriptjs)(Object(f.withGoogleMap)(Object(P.b)(function(e){return{isMobileView:e.windowSize.width<768,welfareCentres:e.filteredWelfareCentres}},function(e){return{onMapFocused:function(){return e({type:z})},onWelfareCentreSelected:function(t){return e(K(t))}}})(x))),Y=(n(590),n(591),n(592),n(101)),q=n.n(Y),$=function(e){var t='<use xlink:href="'.concat(e,'" />');return r.a.createElement("svg",{dangerouslySetInnerHTML:{__html:t}})},ee=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r))))._input=null,n._onInputChange=function(e){n._onChange(e.target.value)},n._onClearButtonClicked=function(){n._onChange(""),n.focus()},n._onFormSubmit=function(e){n.props.onSearchConfirmed(),e.preventDefault()},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"_onChange",value:function(e){this.props.onSearchPhraseChanged(e)}},{key:"focus",value:function(){this._input.focus()}},{key:"render",value:function(){var e=this,t=this.props,n=t.searchPhrase,a=t.showBackButton,o=t.onBackButtonClicked;return r.a.createElement("div",{className:"fulltext"},r.a.createElement("form",{onSubmit:this._onFormSubmit},r.a.createElement("div",{className:"fulltext__inputs"},a&&r.a.createElement("label",{className:"fulltext__button-back"},$(q.a+"#back"),r.a.createElement("input",{type:"button",onClick:o})),r.a.createElement("input",{className:"fulltext__input-text",maxLength:32,onChange:this._onInputChange,placeholder:"Hledat...",ref:function(t){return e._input=t},tabIndex:1,type:"text",value:n||""}),r.a.createElement("label",{className:"fulltext__button-search",tabIndex:2},$(q.a+"#magnifying-glass"),r.a.createElement("input",{type:"submit"})),r.a.createElement("label",{className:"fulltext__button-clear",tabIndex:3},$(q.a+"#close"),r.a.createElement("input",{onClick:this._onClearButtonClicked,type:"button"})))))}}]),t}(a.PureComponent);ee.displayName="FullTextSearch";n(593);var te=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"_renderCategories",value:function(){var e=this,t=Array();return O.forEach(function(n,a){return t.push(r.a.createElement("li",{className:"category-search__category",key:a,onClick:function(){return e.props.onCategorySelected(a)}},r.a.createElement("span",{className:"category-search__category-icon"},$(q.a+"#"+a)),n))}),t}},{key:"render",value:function(){return r.a.createElement("ul",{className:"category-search"},this._renderCategories())}}]),t}(a.Component);te.displayName="CategorySearch";var ne=function(e){return O.get(e)},ae=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e)))._fullTextComponent=null,n._onCategorySelected=function(e){n.setState(function(){return{searchPhrase:ne(e)}},function(){n._onSearchConfirmed()})},n._onSearchPhraseChanged=function(e){n.setState(function(){return{searchPhrase:e}})},n._onSearchConfirmed=function(){n.props.onSearch(n.state.searchPhrase)},n.state={},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.showBackButton,a=t.showCategorySearch,o=t.onBack,i=this.state.searchPhrase;return r.a.createElement("div",{className:"search",onFocus:this.props.onFocus},r.a.createElement(ee,{ref:function(t){return e._fullTextComponent=t},searchPhrase:i,showBackButton:n,onBackButtonClicked:o,onSearchConfirmed:this._onSearchConfirmed,onSearchPhraseChanged:this._onSearchPhraseChanged}),a&&r.a.createElement(te,{onCategorySelected:this._onCategorySelected}))}}]),t}(a.PureComponent);ae.displayName="Search";var re=Object(P.b)(function(e){var t=!(e.windowSize.width<768&&e.isSearchConfirmed)&&!e.selectedWelfareCentre;return{showBackButton:!!e.selectedWelfareCentre,showCategorySearch:t,selectedWelfareCentreName:e.selectedWelfareCentre?e.selectedWelfareCentre.name.value:void 0}},function(e){return{onBack:function(){return e({type:M})},onFocus:function(){return e({type:A})},onSearch:function(t){return e(J(t))}}})(ae),oe=(n(594),function(e){return e.replace(/<[^>]+>/g,"")}),ie=function(e){return!e||!e.trim().length},ce=n(599),le=n(283),se=n.n(le),ue=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e)))._tryLoadStreetViewImage=function(){var e=n.props.welfareCentre,t=e.street.value,a=e.city.value,r=encodeURI("".concat(t,", ").concat(a)),o="".concat(_,"&location=").concat(r,"&size=800x400"),i="".concat(g,"&location=").concat(r,"&size=800x400");ce.a.get(o).subscribe(function(e){n.setState(function(){return{streetViewImageUrl:"ZERO_RESULTS"!==e.response.status?i:void 0}})})},n.state={},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this._tryLoadStreetViewImage()}},{key:"componentDidUpdate",value:function(e){e.welfareCentre!==this.props.welfareCentre&&this._tryLoadStreetViewImage()}},{key:"render",value:function(){var e,t=this.props.welfareCentre,n=this.state.streetViewImageUrl,a=t.name.value,o=t.street.value,i=t.city.value,c=t.zip.value,l=t.openingHours.value,s=t.serviceDescription.value,u=t.phone.value,d=t.web.value;return r.a.createElement("div",{className:"welfare-details"},r.a.createElement("div",{className:"welfare-details__image"},r.a.createElement("img",{src:n||se.a,alt:o})),r.a.createElement("h2",{className:"welfare-details__title"},a),!ie(oe(s))&&r.a.createElement("div",{className:"welfare-details__block welfare-details__block--description"},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.serviceDescription.getHtml()}})),r.a.createElement("div",{className:"welfare-details__block welfare-details__block--address"},r.a.createElement("p",null,o),r.a.createElement("p",null,c," ",i)),!ie(oe(l))&&r.a.createElement("div",{className:"welfare-details__block welfare-details__block--opening-hours"},r.a.createElement("p",{className:"welfare-details__block-title"},"Otev\xedrac\xed doba"),r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.openingHours.getHtml()}})),r.a.createElement("div",{className:"welfare-details__block welfare-details__block--contacts"},r.a.createElement("p",null,!ie(u)&&"Tel: ".concat(u)),r.a.createElement("p",null,!ie(d)&&r.a.createElement("a",{href:(e=d,function(e){return/^http(s)?:\/\//i.test(e)}(e)?e:"http://".concat(e)),target:"_blank"},d))))}}]),t}(a.Component);ue.displayName="WelfareCentreDetails";var de=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.selectedWelfareCentre;return r.a.createElement("div",{className:"sidebar"},r.a.createElement(re,null),e&&r.a.createElement(ue,{welfareCentre:e}))}}]),t}(a.Component);de.displayName="SideBar";var fe=Object(P.b)(function(e,t){return{selectedWelfareCentre:e.selectedWelfareCentre}})(de),pe=function(){},me=function e(){Object(c.a)(this,e)};function he(e){var t=-1,n=pe;return function e(t,n,a){var r=t.then;return Object.assign(t,{cancel:function(){clearTimeout(n),a(new me)},then:function(o,i){return e(r.call(t,o,i),n,a)}})}(new Promise(function(a,r){n=r,t=setTimeout(a,e)}),t,n)}var ve=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e)))._debouncedWindowResize=null,n._debouncedWindowResize=function(e,t){var n,a,r,o;return Object.assign(function(){r=this;for(var i=arguments.length,c=new Array(i),l=0;l<i;l++)c[l]=arguments[l];return a=c,o=function(){return n=null,e.apply(r,a)},n&&(n.cancel(),n=null),n=he(t).then(o),{now:function(){return n?(n.cancel(),n=null,e.apply(r,a)):void 0}}},{now:function(){if(n)return n.cancel(),n=null,o()},cancel:function(){n&&(n.cancel(),n=null)},isPending:function(){return!!n}})}(function(){e.onWindowResized({width:window.innerWidth,height:window.innerHeight})},200),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.onInit(),window.addEventListener("resize",this._debouncedWindowResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._debouncedWindowResize)}},{key:"render",value:function(){return r.a.createElement("div",{className:"app"},r.a.createElement(fe,null),r.a.createElement(Q,{googleMapURL:v,loadingElement:r.a.createElement("div",{style:{height:"100%"}}),containerElement:r.a.createElement("div",{style:{height:"100%"}}),mapElement:r.a.createElement("div",{style:{height:"100%"}})}))}}]),t}(a.Component),ge=Object(P.b)(null,function(e){return{onInit:function(){return e(X())},onWindowResized:function(t){return e(function(e){return{type:H,payload:e}}(t))}}})(ve),_e=n(69),Ce=n(189);var ye=n(284),be={filteredWelfareCentres:[],isSearchConfirmed:!1,loadedWelfareCentres:[],selectedWelfareCentre:null,windowSize:null};var we={width:window.innerWidth,height:window.innerWidth};var ke=Object(_e.c)({filteredWelfareCentres:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be.filteredWelfareCentres,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return t.payload.filteredWelfareCentres;default:return e}},isSearchConfirmed:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case R:case z:return!0;case A:return!1;default:return e}},loadedWelfareCentres:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be.loadedWelfareCentres,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case B:return t.payload.loadedWelfareCentres;default:return e}},selectedWelfareCentre:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be.selectedWelfareCentre,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return t.payload.selectedWelfareCentre;case M:case A:case z:return null;default:return e}},windowSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H:return t.payload;default:return e}}});window.Promise=Ce.a.Promise,Ce.a.on("error",function(e){e?e instanceof me||console.error(e,e.stack):console.error("A reasonless uncaught promise error.")});var Oe=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):_e.d)(Object(_e.a)(ye.a)),Ee=Object(_e.e)(ke,Oe);i.a.render(r.a.createElement(P.a,{store:Ee},r.a.createElement(ge,null)),document.getElementById("root"))}},[[285,1,2]]]);
//# sourceMappingURL=main.668aa03e.chunk.js.map