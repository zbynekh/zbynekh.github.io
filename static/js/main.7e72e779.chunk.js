(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{111:function(e,t,n){e.exports=n.p+"static/media/icons.46b1bc8e.svg"},283:function(e,t,n){e.exports=n.p+"static/media/streetview-not-found.5471f2dd.png"},285:function(e,t,n){e.exports=n(597)},290:function(e,t,n){},490:function(e,t,n){},590:function(e,t,n){},591:function(e,t,n){},592:function(e,t,n){},593:function(e,t,n){},594:function(e,t,n){},597:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),o=n(75),i=n.n(o),c=(n(290),n(15)),l=n(27),s=n(24),u=n(23),d=n(25),f=n(109),p=n(280),m=n.n(p),h="AIzaSyA7RQABjPCiCvlHYTIRvFvmJP_28x-OSMA",v="https://maps.googleapis.com/maps/api/js?key=".concat(h,"&v=3.exp"),g="https://maps.googleapis.com/maps/api/streetview?&key=".concat(h),_="https://maps.googleapis.com/maps/api/streetview/metadata?&key=".concat(h),C={lat:49.8196527,lng:16.0559093},y=8,b=n(281),w=n.n(b),O=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(a))))._onMarkerClick=function(e){n.props.onClick(n.props.id,e.latLng)},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.id,e.latLng),n=e.name,r=e.showLabels;return a.a.createElement(w.a,{labelAnchor:new google.maps.Point(-20,30),labelClass:"marker-with-label",onClick:this._onMarkerClick,position:{lat:t.lat,lng:t.lng},title:n},a.a.createElement("span",null,r&&n))}}]),t}(r.Component);O.displayName="CustomMarker";n(490);var E=new Map([["alcohol","Pot\xed\u017ee s alkoholem"],["drugs","Pot\xed\u017ee s drogami"],["crisis_services","Pomoc v krizi"],["homeless","Bez domova"],["free_time","Voln\xfd \u010das"]]),j=n(282),k=n.n(j),S=function(e,t){var n=W(t),r=n.categoryKey?e.filter(function(e){return L(e.serviceCategories.value,n.categoryKey)}):e;if(n.fullText){var a={keys:["name.value","city.value"],maxPatternLength:32,threshold:.2};return new k.a(r,a).search(n.fullText)}return r},W=function(e){var t=null,n=e;if(E.forEach(function(n,r){e.startsWith(n)&&(t=r)}),t){var r=E.get(t);n=n.replace(r,"")}return{categoryKey:t,fullText:n}},L=function(e,t){return e.some(function(e){return e.codename===t})},x=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e)))._mapComponent=null,n._onMarkerClick=function(e,t){n.props.onWelfareCentreSelected(e),n._mapComponent.panTo(t)},n._onZoomChanged=function(){n.setState(function(){return{currentZoom:n._mapComponent.getZoom()}})},n._fitBoundsToVisibleMarkers=function(e){var t=new google.maps.LatLngBounds;e.forEach(function(e){var n=new google.maps.LatLng(e.gpsLatitude.value,e.gpsLongitude.value);t.extend(n)}),n._mapComponent.fitBounds(t)},n.state={currentLocation:C,currentZoom:y},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"_tryGetCurrentLocation",value:function(){var e=this;navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){e.setState(function(){return{currentLocation:{lat:t.coords.latitude,lng:t.coords.longitude},currentZoom:13}})})}},{key:"componentDidMount",value:function(){this._tryGetCurrentLocation()}},{key:"componentDidUpdate",value:function(e){var t=this.props.welfareCentres;if(t!==e.welfareCentres&&t.length>0){var n=this.state.currentLocation&&function(e,t){return e.filter(function(e){return t.contains({lat:e.gpsLatitude.value,lng:e.gpsLongitude.value})})}(t,this._mapComponent.getBounds()),r=n.length>1?n:t;this._fitBoundsToVisibleMarkers(r)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.onMapFocused,r=t.welfareCentres,o=this.state,i=o.currentZoom,c=o.currentLocation;return a.a.createElement(f.GoogleMap,{center:c,defaultCenter:C,defaultZoom:y,onZoomChanged:this._onZoomChanged,onClick:n,options:{fullscreenControl:!1,mapTypeControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},maxZoom:18},ref:function(t){return e._mapComponent=t},zoom:i},r&&a.a.createElement(m.a,{averageCenter:!0,enableRetinaIcons:!0,gridSize:25},r.map(function(t){return a.a.createElement(O,{id:t.system.codename,key:t.system.codename,latLng:{lat:t.gpsLatitude.value,lng:t.gpsLongitude.value},name:t.name.value,onClick:e._onMarkerClick,showLabels:i>12})})))}}]),t}(r.PureComponent);x.displayName="Map";var P=n(55),N=n(60),I=n.n(N),T=n(94),M="App_Init_Finished",z="App_Map_Focused",R="App_Search_Confirmed",A="App_Search_Focused",D="App_WelfareCentre_Selected",H="App_Window_Resized",F=n(110),B=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(s.a)(this,Object(u.a)(t).call(this,{propertyResolver:function(e){return"service_categories"===e?"serviceCategories":"service_description"===e?"serviceDescription":"opening_hours"===e?"openingHours":"gps_latitude"===e?"gpsLatitude":"gps_longitude"===e?"gpsLongitude":e}}))).name=void 0,e.serviceCategories=void 0,e.serviceDescription=void 0,e.openingHours=void 0,e.street=void 0,e.city=void 0,e.zip=void 0,e.gpsLatitude=void 0,e.gpsLongitude=void 0,e.phone=void 0,e.web=void 0,e}return Object(d.a)(t,e),t}(F.ContentItem),Z=new F.DeliveryClient({projectId:"63208e4e-b4d4-00d2-78df-cfe9db943907",typeResolvers:[new F.TypeResolver("welfare_centre",function(){return new B})]}),U=function(){return Z.items().type("welfare_centre").elementsParameter(["name","service_categories","city","gps_latitude","gps_longitude"]).getPromise()},V=function(e){return Z.item(e).getPromise()},G=function(){return function(){var e=Object(T.a)(I.a.mark(function e(t){var n;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U();case 2:n=e.sent,t((r={loadedWelfareCentres:n.items},{type:M,payload:r}));case 4:case"end":return e.stop()}var r},e)}));return function(t){return e.apply(this,arguments)}}()},X=function(e){return function(){var t=Object(T.a)(I.a.mark(function t(n,r){var a,o,i;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=r(),o=a.loadedWelfareCentres,i=S(o,e),n({type:R,payload:{filteredWelfareCentres:i}});case 3:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()},J=function(e){return function(){var t=Object(T.a)(I.a.mark(function t(n,r){var a,o,i;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r(),(o=a.selectedWelfareCentre)&&o.system.codename==e){t.next=7;break}return t.next=5,V(e);case 5:i=t.sent,n((c={selectedWelfareCentre:i.item},{type:D,payload:c}));case 7:case"end":return t.stop()}var c},t)}));return function(e,n){return t.apply(this,arguments)}}()},K=Object(f.withScriptjs)(Object(f.withGoogleMap)(Object(P.b)(function(e){return{welfareCentres:e.filteredWelfareCentres}},function(e){return{onMapFocused:function(){return e({type:z})},onWelfareCentreSelected:function(t){return e(J(t))}}})(x))),Q=(n(590),n(591),n(592),n(111)),Y=n.n(Q),q=function(e){var t='<use xlink:href="'.concat(e,'" />');return a.a.createElement("svg",{dangerouslySetInnerHTML:{__html:t}})},$=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(a))))._input=null,n._onInputChange=function(e){n._onChange(e.target.value)},n._onClearButtonClicked=function(){n._onChange(""),n.focus()},n._onFormSubmit=function(e){n.props.onSearchConfirmed(),e.preventDefault()},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"_onChange",value:function(e){this.props.onSearchPhraseChanged(e)}},{key:"focus",value:function(){this._input.focus()}},{key:"render",value:function(){var e=this,t=this.props.searchPhrase;return a.a.createElement("div",{className:"fulltext"},a.a.createElement("form",{onSubmit:this._onFormSubmit},a.a.createElement("div",{className:"fulltext__inputs"},a.a.createElement("input",{className:"fulltext__input-text",maxLength:32,onChange:this._onInputChange,placeholder:"Hledat...",ref:function(t){return e._input=t},tabIndex:1,type:"text",value:t||""}),a.a.createElement("label",{className:"fulltext__button-search",tabIndex:2},q(Y.a+"#magnifying-glass"),a.a.createElement("input",{type:"submit"})),a.a.createElement("label",{className:"fulltext__button-clear",tabIndex:3},q(Y.a+"#close"),a.a.createElement("input",{onClick:this._onClearButtonClicked,type:"button"})))))}}]),t}(r.PureComponent);$.displayName="FullTextSearch";n(593);var ee=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"_renderCategories",value:function(){var e=this,t=Array();return E.forEach(function(n,r){return t.push(a.a.createElement("li",{className:"category-search__category",key:r,onClick:function(){return e.props.onCategorySelected(r)}},a.a.createElement("span",{className:"category-search__category-icon"},q(Y.a+"#"+r)),n))}),t}},{key:"render",value:function(){return a.a.createElement("ul",{className:"category-search"},this._renderCategories())}}]),t}(r.Component);ee.displayName="CategorySearch";var te=function(e){return E.get(e)},ne=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e)))._fullTextComponent=null,n._onCategorySelected=function(e){n.setState(function(){return{searchPhrase:te(e)}},function(){n._onSearchConfirmed()})},n._onSearchPhraseChanged=function(e){n.setState(function(){return{searchPhrase:e}})},n._onSearchConfirmed=function(){n.props.onSearch(n.state.searchPhrase)},n.state={},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.showCategorySearch,r=(t.selectedWelfareCentreName,this.state.searchPhrase);return a.a.createElement("div",{className:"search",onFocus:this.props.onFocus},a.a.createElement($,{ref:function(t){return e._fullTextComponent=t},searchPhrase:r,onSearchConfirmed:this._onSearchConfirmed,onSearchPhraseChanged:this._onSearchPhraseChanged}),n&&a.a.createElement(ee,{onCategorySelected:this._onCategorySelected}))}}]),t}(r.PureComponent);ne.displayName="Search";var re=Object(P.b)(function(e){return{showCategorySearch:!(e.windowSize.width<768&&e.isSearchConfirmed)&&!e.selectedWelfareCentre,selectedWelfareCentreName:e.selectedWelfareCentre?e.selectedWelfareCentre.name.value:void 0}},function(e){return{onFocus:function(){return e({type:A})},onSearch:function(t){return e(X(t))}}})(ne),ae=(n(594),function(e){return e.replace(/<[^>]+>/g,"")}),oe=function(e){return!e||!e.trim().length},ie=n(599),ce=n(283),le=n.n(ce),se=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e)))._tryLoadStreetViewImage=function(){var e=n.props.welfareCentre,t=e.street.value,r=e.city.value,a=encodeURI("".concat(t,", ").concat(r)),o="".concat(_,"&location=").concat(a,"&size=390x200"),i="".concat(g,"&location=").concat(a,"&size=390x200");ie.a.get(o).subscribe(function(e){n.setState(function(){return{streetViewImageUrl:"ZERO_RESULTS"!==e.response.status?i:void 0}})})},n.state={},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this._tryLoadStreetViewImage()}},{key:"componentDidUpdate",value:function(e){e.welfareCentre!==this.props.welfareCentre&&this._tryLoadStreetViewImage()}},{key:"render",value:function(){var e,t=this.props.welfareCentre,n=this.state.streetViewImageUrl,r=t.name.value,o=t.street.value,i=t.city.value,c=t.zip.value,l=t.openingHours.value,s=t.serviceDescription.value,u=t.phone.value,d=t.web.value;return a.a.createElement("div",{className:"welfare-details"},a.a.createElement("img",{src:n||le.a,alt:o}),a.a.createElement("h2",{className:"welfare-details__title"},r),!oe(ae(s))&&a.a.createElement("div",{className:"welfare-details__block welfare-details__block--description"},a.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.serviceDescription.getHtml()}})),a.a.createElement("div",{className:"welfare-details__block welfare-details__block--address"},a.a.createElement("p",null,o),a.a.createElement("p",null,c," ",i)),!oe(ae(l))&&a.a.createElement("div",{className:"welfare-details__block welfare-details__block--opening-hours"},a.a.createElement("p",{className:"welfare-details__block-title"},"Otev\xedrac\xed doba"),a.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.openingHours.getHtml()}})),a.a.createElement("div",{className:"welfare-details__block welfare-details__block--contacts"},a.a.createElement("p",null,!oe(u)&&"Tel: ".concat(u)),a.a.createElement("p",null,!oe(d)&&a.a.createElement("a",{href:(e=d,function(e){return/^http(s)?:\/\//i.test(e)}(e)?e:"http://".concat(e)),target:"_blank"},d))))}}]),t}(r.Component);se.displayName="WelfareCentreDetails";var ue=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.selectedWelfareCentre;return a.a.createElement("div",{className:"sidebar"},a.a.createElement(re,null),e&&a.a.createElement(se,{welfareCentre:e}))}}]),t}(r.Component);ue.displayName="SideBar";var de=Object(P.b)(function(e,t){return{selectedWelfareCentre:e.selectedWelfareCentre}})(ue),fe=function(){},pe=function e(){Object(c.a)(this,e)};function me(e){var t=-1,n=fe;return function e(t,n,r){var a=t.then;return Object.assign(t,{cancel:function(){clearTimeout(n),r(new pe)},then:function(o,i){return e(a.call(t,o,i),n,r)}})}(new Promise(function(r,a){n=a,t=setTimeout(r,e)}),t,n)}var he=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(s.a)(this,Object(u.a)(t).call(this,e)))._debouncedWindowResize=null,n._debouncedWindowResize=function(e,t){var n,r,a,o;return Object.assign(function(){a=this;for(var i=arguments.length,c=new Array(i),l=0;l<i;l++)c[l]=arguments[l];return r=c,o=function(){return n=null,e.apply(a,r)},n&&(n.cancel(),n=null),n=me(t).then(o),{now:function(){return n?(n.cancel(),n=null,e.apply(a,r)):void 0}}},{now:function(){if(n)return n.cancel(),n=null,o()},cancel:function(){n&&(n.cancel(),n=null)},isPending:function(){return!!n}})}(function(){e.onWindowResized({width:window.innerWidth,height:window.innerHeight})},200),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.onInit(),window.addEventListener("resize",this._debouncedWindowResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._debouncedWindowResize)}},{key:"render",value:function(){return a.a.createElement("div",{className:"app"},a.a.createElement(de,null),a.a.createElement(K,{googleMapURL:v,loadingElement:a.a.createElement("div",{style:{height:"100%"}}),containerElement:a.a.createElement("div",{style:{height:"100%"}}),mapElement:a.a.createElement("div",{style:{height:"100%"}})}))}}]),t}(r.Component),ve=Object(P.b)(null,function(e){return{onInit:function(){return e(G())},onWindowResized:function(t){return e(function(e){return{type:H,payload:e}}(t))}}})(he),ge=n(69),_e=n(189);var Ce=n(284),ye={filteredWelfareCentres:[],isSearchConfirmed:!1,loadedWelfareCentres:[],selectedWelfareCentre:null,windowSize:null};var be={width:window.innerWidth,height:window.innerWidth};var we=Object(ge.c)({filteredWelfareCentres:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye.filteredWelfareCentres,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return t.payload.filteredWelfareCentres;default:return e}},isSearchConfirmed:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case R:case z:return!0;case A:return!1;default:return e}},loadedWelfareCentres:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye.loadedWelfareCentres,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return t.payload.loadedWelfareCentres;default:return e}},selectedWelfareCentre:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye.selectedWelfareCentre,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return t.payload.selectedWelfareCentre;case A:case z:return null;default:return e}},windowSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H:return t.payload;default:return e}}});window.Promise=_e.a.Promise,_e.a.on("error",function(e){e?e instanceof pe||console.error(e,e.stack):console.error("A reasonless uncaught promise error.")});var Oe=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):ge.d)(Object(ge.a)(Ce.a)),Ee=Object(ge.e)(we,Oe);i.a.render(a.a.createElement(P.a,{store:Ee},a.a.createElement(ve,null)),document.getElementById("root"))}},[[285,1,2]]]);
//# sourceMappingURL=main.7e72e779.chunk.js.map