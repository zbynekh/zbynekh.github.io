(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{111:function(e,t,n){e.exports=n.p+"static/media/icons.46b1bc8e.svg"},283:function(e,t,n){e.exports=n.p+"static/media/streetview-not-found.5471f2dd.png"},285:function(e,t,n){e.exports=n(597)},290:function(e,t,n){},490:function(e,t,n){},590:function(e,t,n){},591:function(e,t,n){},592:function(e,t,n){},593:function(e,t,n){},594:function(e,t,n){},597:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(75),c=n.n(o),i=(n(290),n(15)),s=n(27),l=n(24),u=n(23),p=n(25),f=n(109),d=n(280),h=n.n(d),m="AIzaSyA7RQABjPCiCvlHYTIRvFvmJP_28x-OSMA",v="https://maps.googleapis.com/maps/api/js?key=".concat(m,"&v=3.exp"),g="https://maps.googleapis.com/maps/api/streetview?&key=".concat(m),C="https://maps.googleapis.com/maps/api/streetview/metadata?&key=".concat(m),_={lat:49.8196527,lng:16.0559093},b=8,y=n(281),O=n.n(y),w=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r))))._onMarkerClick=function(e){n.props.onClick(n.props.id,e.latLng)},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.id,e.latLng),n=e.name,a=e.showLabels;return r.a.createElement(O.a,{labelAnchor:new google.maps.Point(-20,30),labelClass:"marker-with-label",onClick:this._onMarkerClick,position:{lat:t.lat,lng:t.lng},title:n},r.a.createElement("span",null,a&&n))}}]),t}(a.Component);w.displayName="CustomMarker";n(490);var E=new Map([["alcohol","Pot\xed\u017ee s alkoholem"],["drugs","Pot\xed\u017ee s drogami"],["crisis_services","Pomoc v krizi"],["homeless","Bez domova"],["free_time","Voln\xfd \u010das"]]),j=n(282),k=n.n(j),S=function(e,t){var n=P(t),a=n.categoryKey?e.filter(function(e){return L(e.serviceCategories.value,n.categoryKey)}):e;if(n.fullText){var r={keys:["name.value","city.value"],maxPatternLength:32,threshold:.2};return new k.a(a,r).search(n.fullText)}return a},P=function(e){var t=null,n=e;if(E.forEach(function(n,a){e.startsWith(n)&&(t=a)}),t){var a=E.get(t);n=n.replace(a,"")}return{categoryKey:t,fullText:n}},L=function(e,t){return e.some(function(e){return e.codename===t})},x=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e)))._mapComponent=null,n._onMarkerClick=function(e,t){n.props.onWelfareCentreSelected(e),n._mapComponent.panTo(t)},n._onZoomChanged=function(){n.setState(function(){return{currentZoom:n._mapComponent.getZoom()}})},n._fitBoundsToVisibleMarkers=function(e){var t=new google.maps.LatLngBounds;e.forEach(function(e){var n=new google.maps.LatLng(e.gpsLatitude.value,e.gpsLongitude.value);t.extend(n)}),n._mapComponent.fitBounds(t)},n.state={currentLocation:_,currentZoom:b},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"_tryGetCurrentLocation",value:function(){var e=this;navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){e.setState(function(){return{currentLocation:{lat:t.coords.latitude,lng:t.coords.longitude},currentZoom:13}})})}},{key:"componentDidMount",value:function(){this._tryGetCurrentLocation()}},{key:"componentDidUpdate",value:function(e){var t=this.props.welfareCentres;if(t!==e.welfareCentres&&t.length>0){var n=this.state.currentLocation&&function(e,t){return e.filter(function(e){return t.contains({lat:e.gpsLatitude.value,lng:e.gpsLongitude.value})})}(t,this._mapComponent.getBounds()),a=n.length>1?n:t;this._fitBoundsToVisibleMarkers(a)}}},{key:"render",value:function(){var e=this,t=this.props.welfareCentres,n=this.state,a=n.currentZoom,o=n.currentLocation;return r.a.createElement(f.GoogleMap,{center:o,defaultCenter:_,defaultZoom:b,onZoomChanged:this._onZoomChanged,options:{fullscreenControl:!1,mapTypeControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},maxZoom:18},ref:function(t){return e._mapComponent=t},zoom:a},t&&r.a.createElement(h.a,{averageCenter:!0,enableRetinaIcons:!0,gridSize:25},t.map(function(t){return r.a.createElement(w,{id:t.system.codename,key:t.system.codename,latLng:{lat:t.gpsLatitude.value,lng:t.gpsLongitude.value},name:t.name.value,onClick:e._onMarkerClick,showLabels:a>12})})))}}]),t}(a.PureComponent);x.displayName="Map";var N=n(55),W=n(60),I=n.n(W),T=n(94),M="App_Init_Finished",D="App_Search_Confirmed",A="App_Search_Focused",R="App_WelfareCentre_Selected",H=n(110),B=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this,{propertyResolver:function(e){return"service_categories"===e?"serviceCategories":"service_description"===e?"serviceDescription":"opening_hours"===e?"openingHours":"gps_latitude"===e?"gpsLatitude":"gps_longitude"===e?"gpsLongitude":e}}))).name=void 0,e.serviceCategories=void 0,e.serviceDescription=void 0,e.openingHours=void 0,e.street=void 0,e.city=void 0,e.zip=void 0,e.gpsLatitude=void 0,e.gpsLongitude=void 0,e.phone=void 0,e.web=void 0,e}return Object(p.a)(t,e),t}(H.ContentItem),U=new H.DeliveryClient({projectId:"63208e4e-b4d4-00d2-78df-cfe9db943907",typeResolvers:[new H.TypeResolver("welfare_centre",function(){return new B})]}),Z=function(){return U.items().type("welfare_centre").elementsParameter(["name","service_categories","city","gps_latitude","gps_longitude"]).getPromise()},V=function(e){return U.item(e).getPromise()},z=function(){return function(){var e=Object(T.a)(I.a.mark(function e(t){var n;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z();case 2:n=e.sent,t((a={loadedWelfareCentres:n.items},{type:M,payload:a}));case 4:case"end":return e.stop()}var a},e)}));return function(t){return e.apply(this,arguments)}}()},F=function(e){return function(){var t=Object(T.a)(I.a.mark(function t(n,a){var r,o,c;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=a(),o=r.loadedWelfareCentres,c=S(o,e),n({type:D,payload:{filteredWelfareCentres:c}});case 3:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()},G=function(e){return function(){var t=Object(T.a)(I.a.mark(function t(n,a){var r,o,c;return I.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=a(),(o=r.selectedWelfareCentre)&&o.system.codename==e){t.next=7;break}return t.next=5,V(e);case 5:c=t.sent,n((i={selectedWelfareCentre:c.item},{type:R,payload:i}));case 7:case"end":return t.stop()}var i},t)}));return function(e,n){return t.apply(this,arguments)}}()},K=Object(f.withScriptjs)(Object(f.withGoogleMap)(Object(N.b)(function(e){return{welfareCentres:e.filteredWelfareCentres}},function(e){return{onWelfareCentreSelected:function(t){return e(G(t))}}})(x))),X=(n(590),n(591),function(){}),J=function e(){Object(i.a)(this,e)};function Q(e){var t=-1,n=X;return function e(t,n,a){var r=t.then;return Object.assign(t,{cancel:function(){clearTimeout(n),a(new J)},then:function(o,c){return e(r.call(t,o,c),n,a)}})}(new Promise(function(a,r){n=r,t=setTimeout(a,e)}),t,n)}n(592);var Y=n(111),q=n.n(Y),$=function(e){var t='<use xlink:href="'.concat(e,'" />');return r.a.createElement("svg",{dangerouslySetInnerHTML:{__html:t}})},ee=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e)))._debouncedOnSearchPhraseChanged=void 0,n._onInputChange=function(e){n._onChange(e.target.value)},n._onClearButtonClicked=function(){n._onChange("")},n._onFormSubmit=function(e){n._debouncedOnSearchPhraseChanged.cancel(),n.props.onSearchConfirmed(n.state.searchPhrase),e.preventDefault()},n._debouncedOnSearchPhraseChanged=function(e,t){var n,a,r,o;return Object.assign(function(){r=this;for(var c=arguments.length,i=new Array(c),s=0;s<c;s++)i[s]=arguments[s];return a=i,o=function(){return n=null,e.apply(r,a)},n&&(n.cancel(),n=null),n=Q(t).then(o),{now:function(){return n?(n.cancel(),n=null,e.apply(r,a)):void 0}}},{now:function(){if(n)return n.cancel(),n=null,o()},cancel:function(){n&&(n.cancel(),n=null)},isPending:function(){return!!n}})}(e.onSearchPhraseChanged,500),n.state={searchPhrase:e.searchPhrase||""},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e,t){var n=this,a=this.props.searchPhrase!==e.searchPhrase,r=this.state.searchPhrase!==t.searchPhrase,o=this.props.searchPhrase===this.state.searchPhrase;(a||!o&&!r)&&(this.setState(function(){return{searchPhrase:n.props.searchPhrase}}),this.props.onSearchConfirmed(this.props.searchPhrase))}},{key:"componentWillUnmount",value:function(){this._debouncedOnSearchPhraseChanged.cancel()}},{key:"_onChange",value:function(e){this.setState({searchPhrase:e}),this._debouncedOnSearchPhraseChanged(e)}},{key:"render",value:function(){return r.a.createElement("div",{className:"fulltext"},r.a.createElement("form",{onSubmit:this._onFormSubmit},r.a.createElement("div",{className:"fulltext__inputs"},r.a.createElement("input",{className:"fulltext__input-text",maxLength:32,onChange:this._onInputChange,placeholder:"Hledat...",tabIndex:1,type:"text",value:this.state.searchPhrase}),r.a.createElement("label",{className:"fulltext__button-search",tabIndex:2},$(q.a+"#magnifying-glass"),r.a.createElement("input",{type:"submit"})),r.a.createElement("label",{className:"fulltext__button-clear",tabIndex:3},$(q.a+"#close"),r.a.createElement("input",{onClick:this._onClearButtonClicked,type:"button"})))))}}]),t}(a.Component);ee.displayName="FullTextSearch";n(593);var te=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"_renderCategories",value:function(){var e=this,t=Array();return E.forEach(function(n,a){return t.push(r.a.createElement("li",{className:"category-search__category",key:a,onClick:function(){return e.props.onCategorySelected(a)}},r.a.createElement("span",{className:"category-search__category-icon"},$(q.a+"#"+a)),n))}),t}},{key:"render",value:function(){return r.a.createElement("ul",{className:"category-search"},this._renderCategories())}}]),t}(a.Component);te.displayName="CategorySearch";var ne=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e)))._onCategorySelected=function(e){n.setState(function(){return{selectedCategoryKey:e}})},n.state={},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e,t=this.props.selectedWelfareCentreName,n=(e=this.state.selectedCategoryKey,E.get(e));return r.a.createElement("div",{className:"search",onFocus:this.props.onFocus},r.a.createElement(ee,{searchPhrase:n,onSearchConfirmed:this.props.onSearch,onSearchPhraseChanged:function(){return!0}}),!t&&r.a.createElement(te,{onCategorySelected:this._onCategorySelected}))}}]),t}(a.Component);ne.displayName="Search";var ae=Object(N.b)(function(e){return{selectedWelfareCentreName:e.selectedWelfareCentre?e.selectedWelfareCentre.name.value:void 0}},function(e){return{onFocus:function(){return e({type:A})},onSearch:function(t){return e(F(t))}}})(ne),re=(n(594),function(e){return e.replace(/<[^>]+>/g,"")}),oe=function(e){return!e||!e.trim().length},ce=n(599),ie=n(283),se=n.n(ie),le=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e)))._tryLoadStreetViewImage=function(){var e=n.props.welfareCentre,t=e.street.value,a=e.city.value,r=encodeURI("".concat(t,", ").concat(a)),o="".concat(C,"&location=").concat(r,"&size=390x200"),c="".concat(g,"&location=").concat(r,"&size=390x200");ce.a.get(o).subscribe(function(e){n.setState(function(){return{streetViewImageUrl:"ZERO_RESULTS"!==e.response.status?c:void 0}})})},n.state={},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._tryLoadStreetViewImage()}},{key:"componentDidUpdate",value:function(e){e.welfareCentre!==this.props.welfareCentre&&this._tryLoadStreetViewImage()}},{key:"render",value:function(){var e,t=this.props.welfareCentre,n=this.state.streetViewImageUrl,a=t.name.value,o=t.street.value,c=t.city.value,i=t.zip.value,s=t.openingHours.value,l=t.serviceDescription.value,u=t.phone.value,p=t.web.value;return r.a.createElement("div",{className:"welfare-details"},r.a.createElement("img",{src:n||se.a,alt:o}),r.a.createElement("h2",{className:"welfare-details__title"},a),!oe(re(l))&&r.a.createElement("div",{className:"welfare-details__block welfare-details__block--description"},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.serviceDescription.getHtml()}})),r.a.createElement("div",{className:"welfare-details__block welfare-details__block--address"},r.a.createElement("p",null,o),r.a.createElement("p",null,i," ",c)),!oe(re(s))&&r.a.createElement("div",{className:"welfare-details__block welfare-details__block--opening-hours"},r.a.createElement("p",{className:"welfare-details__block-title"},"Otev\xedrac\xed doba"),r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.openingHours.getHtml()}})),r.a.createElement("div",{className:"welfare-details__block welfare-details__block--contacts"},r.a.createElement("p",null,!oe(u)&&"Tel: ".concat(u)),r.a.createElement("p",null,!oe(p)&&r.a.createElement("a",{href:(e=p,function(e){return/^http(s)?:\/\//i.test(e)}(e)?e:"http://".concat(e)),target:"_blank"},p))))}}]),t}(a.Component);le.displayName="WelfareCentreDetails";var ue=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.selectedWelfareCentre;return r.a.createElement("div",{className:"sidebar"},r.a.createElement(ae,null),e&&r.a.createElement(le,{welfareCentre:e}))}}]),t}(a.Component);ue.displayName="SideBar";var pe=Object(N.b)(function(e,t){return{selectedWelfareCentre:e.selectedWelfareCentre}})(ue),fe=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.onInit()}},{key:"render",value:function(){return r.a.createElement("div",{className:"app"},r.a.createElement(pe,null),r.a.createElement(K,{googleMapURL:v,loadingElement:r.a.createElement("div",{style:{height:"100%"}}),containerElement:r.a.createElement("div",{style:{height:"100%"}}),mapElement:r.a.createElement("div",{style:{height:"100%"}})}))}}]),t}(a.Component),de=Object(N.b)(null,function(e){return{onInit:function(){return e(z())}}})(fe),he=n(69),me=n(189);var ve=n(284),ge={filteredWelfareCentres:[],loadedWelfareCentres:[],selectedWelfareCentre:null};var Ce=Object(he.c)({filteredWelfareCentres:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge.filteredWelfareCentres,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return t.payload.filteredWelfareCentres;default:return e}},loadedWelfareCentres:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge.loadedWelfareCentres,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return t.payload.loadedWelfareCentres;default:return e}},selectedWelfareCentre:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge.selectedWelfareCentre,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return t.payload.selectedWelfareCentre;case A:return null;default:return e}}});window.Promise=me.a.Promise,me.a.on("error",function(e){e?e instanceof J||console.error(e,e.stack):console.error("A reasonless uncaught promise error.")});var _e=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):he.d)(Object(he.a)(ve.a)),be=Object(he.e)(Ce,_e);c.a.render(r.a.createElement(N.a,{store:be},r.a.createElement(de,null)),document.getElementById("root"))}},[[285,1,2]]]);
//# sourceMappingURL=main.e2be7ee8.chunk.js.map